var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,s=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&l(e,n,t[n]);if(a)for(var n of a(t))i.call(t,n)&&l(e,n,t[n]);return e},o=(e,a)=>t(e,n(a));"undefined"!=typeof require&&require;import{a as c,i as u,R as d,r as m,l as p,j as f,f as v,e as h,S as g,b as E,c as y}from"./vendor.575806bc.js";async function b(e){return await c.get(`prediccion/especifica/municipio/diaria/${e.replace("id","")}`).then((e=>e.data)).then((e=>{if(200!==e.estado)throw new Error(e.descripcion);return e})).then((async({datos:e})=>await c.get(e))).then((e=>{var t;return{data:e.data[0].prediccion.dia.find((e=>u(new Date(e.fecha)))),name:e.data[0].nombre,date:null==(t=e.data[0].prediccion.dia.find((e=>u(new Date(e.fecha)))))?void 0:t.fecha}})).then((e=>{if(void 0!==(null==e?void 0:e.data)&&void 0!==(null==e?void 0:e.date))return t=e.data,n=e.name,a=new Date(null==e?void 0:e.date),{name:n,date:a,probPrecipitaciones:_(t.probPrecipitacion),humedadMinMax:{max:t.humedadRelativa.maxima,min:t.humedadRelativa.minima},temperaturaMinMax:{max:t.sensTermica.maxima,min:t.sensTermica.minima},estadoCielo:C(t.estadoCielo),humedad:w(t.humedadRelativa.dato),temperatura:w(t.sensTermica.dato)};throw new Error("No data found");var t,n,a}))}function _(e){const t=["00-06","06-12","12-18","18-24"],n=[];return e.filter((e=>t.includes(e.periodo))).forEach((e=>{if(t.includes(e.periodo)){const t=e.periodo.split("-"),a=Number(t[0])+1,r=Number(t[1])+1;for(let i=a;i<r;i++)n.push({hour:"24"===i.toString().padStart(2,"0")?"00":i.toString().padStart(2,"0"),value:e.value})}})),n}function w(e){const t=[];return e.unshift({hora:0,value:e[0].value}),e.forEach(((n,a)=>{if(24!==n.hora){const r=Math.abs(e[a+1].value-n.value)/6;for(let i=n.hora;i<e[a+1].hora;i++){const l=r*(i-n.hora);t.push({hour:i.toString(),value:e[a+1].value>n.value?n.value+l:n.value-l})}}else t.push({hour:"00",value:n.value})})),t}function C(e){return _(e.map((e=>({periodo:e.periodo,value:e.value}))))}function N(e){var t;const n=(new Date).getHours(),a=(new Date).getHours().toString().padStart(2,"0"),r=null==(t=e.estadoCielo.find((e=>e.hour===a)))?void 0:t.value.toString(),i=n>=7&&n<=10,l=n>=11&&n<=17,s=n>=18&&n<=22;return void 0===r?"./src/assets/day-sunny.jpg":void 0!==r&&["43","43n","44","44n","45","46","23","23n","24","24n","25","26"].includes(r)?"./src/assets/day-rain.png":void 0!==r&&["51","51n","52","52n","53","54","61","61n","62","62n","63","64"].includes(r)?"./src/assets/electrical-storm.jpg":void 0!==r&&["71","71n","72","72n","73","74","33","33n","34","34n","35","36"].includes(r)?"./src/assets/snow.jpg":void 0!==r&&["12","12n","14","14n","13n","13","17","17n"].includes(r)?i?"./src/assets/sunrise-cloudy.jpg":l?"./src/assets/day-cloudy.jpg":"./src/assets/sunset-cloudy.jpg":void 0!==r&&["11","11n","81","82","83"].includes(r)?i?"./src/assets/sunrise-sunny.jpg":l?"./src/assets/day-sunny.jpg":s?"./src/assets/sunset-sunny.jpg":"./src/assets/night.jpg":void 0!==r&&["15","16"].includes(r)?"./src/assets/cover.jpg":"./src/assets/day-sunny.jpg"}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const x=d.createContext({cities:[],setCities:e=>null});function k({children:e}){const[t,n]=m.exports.useState([]);return m.exports.useEffect((()=>{p.getItem("cities").then((e=>{null===e||0===e.length?async function(){return await c.get("maestro/municipios").then((e=>e.data))}().then((async e=>await p.setItem("cities",e))).then((e=>n(e))).catch((e=>console.error(e))):n(e)})).catch((e=>console.error(e)))}),[]),d.createElement(x.Provider,{value:{cities:t,setCities:n}},e)}const S=d.createContext({citiesSaved:[],saveCities:()=>{}});function j({children:e}){const[t,n]=m.exports.useState([]);return m.exports.useEffect((()=>{p.setItem("saveCities",t).catch((e=>console.error(e)))}),[t]),m.exports.useEffect((()=>{p.getItem("saveCities").then((e=>{null!==e&&e.length>0&&n(e)})).catch((e=>console.error(e)))}),[]),d.createElement(S.Provider,{value:{citiesSaved:t,saveCities:n}},e)}function I(e){const[t,n]=m.exports.useState(!1),[a,r]=m.exports.useState();return m.exports.useEffect((()=>{null!=e&&(n(!0),b(e).then((e=>r(e))).finally((()=>n(!1))))}),[e]),{weather:a,loading:t}}function L(e){const{weather:t}=I(e.id);return d.createElement(d.Fragment,null,d.createElement("pre",null,d.createElement("code",null,JSON.stringify(t,null,2))))}var M="_mainContainer_1w5gh_1";var O="_autoCompleteBox_bmfp7_1",D="_autocompleteWrapper_bmfp7_11",T="_item_bmfp7_15",F="_itemLink_bmfp7_20";var q="_input_gsffu_1";function J(e){var t;return d.createElement(d.Fragment,null,d.createElement("input",o(s({},e),{className:`${q} ${null!=(t=e.className)?t:""}`})))}function P(e){const[t,n]=m.exports.useState([]),[a,r]=m.exports.useState(""),[i,l]=m.exports.useState(null),c=m.exports.useRef([]),u=m.exports.useRef(null);m.exports.useEffect((()=>(document.addEventListener("click",p,!1),()=>{document.removeEventListener("click",p,!1)})),[]);const p=e=>{null===(null==u?void 0:u.current)||u.current.contains(e.target)||n([])},v=m.exports.useCallback(f((t=>n((()=>{var n;return e.items.filter((e=>e.label.toLocaleLowerCase().includes(t.toLocaleLowerCase()))).slice(0,null!=(n=e.limit)?n:50)}))),500),[n]),h=e=>{if("ArrowDown"!==e.key&&"ArrowUp"!==e.key)return;const t=null===i?0:c.current.indexOf(i);let n;if("ArrowDown"===e.key){const e=t+1===c.current.length?0:t+1;n=c.current[e]}else{const e=t-1<0?c.current.length-1:t-1;n=c.current[e]}l(n),n.focus()};return m.exports.useEffect((()=>{""!==a.trim()&&v(a)}),[a]),d.createElement(d.Fragment,null,d.createElement("div",{className:D,ref:u},d.createElement(J,o(s({},e.input),{value:a,onFocus:()=>l(null),onChange:e=>r(e.target.value),onKeyDown:e=>h(e)})),d.createElement("ul",{className:O},t.map((t=>d.createElement("li",{key:t.id,className:T},d.createElement("a",{onClick:a=>{a.preventDefault(),e.onClickItem(t),n([]),r("")},onKeyDown:e=>h(e),ref:e=>null!==e?c.current.push(e):null,className:F},t.label)))))))}function R(){const{saveCities:e,citiesSaved:t}=m.exports.useContext(S);return{savedCities:t,addNewCity:m.exports.useCallback((t=>{e((e=>e.some((e=>t.id===e.id))?e:[...e,t]))}),[t]),deleteCity:m.exports.useCallback((t=>{e((e=>e.filter((e=>e.id!==t.id))))}),[t])}}function z(){const{cities:e}=function(){const{cities:e}=m.exports.useContext(x),t=m.exports.useCallback((t=>e.find((e=>e.id===t))),[e]);return{cities:e,findCity:t}}(),{addNewCity:t}=R();return d.createElement(P,{input:{placeholder:"Busca tu ciudad"},limit:10,placeholder:"Localidad",items:e.map((e=>({id:e.id,label:e.nombre,value:e}))),onClickItem:e=>{t(e.value)}})}var Y="_aside_1qbb5_1",B="_hamburguer_1qbb5_14",A="_separator_1qbb5_26",H="_selectedCity_1qbb5_30",U="_header_1qbb5_34",W="_close_1qbb5_39";function G({onClickCity:e}){const{savedCities:t}=R(),[n,a]=m.exports.useState(null),[r,i]=m.exports.useState(!1);m.exports.useEffect((()=>{null===n&&t.length>0&&l(t[0])}),[t]);const l=t=>{a(t),e(t)};return d.createElement(d.Fragment,null,d.createElement("svg",{onClick:()=>i(!0),viewBox:"0 0 100 80",width:"80",className:B,height:"60",style:{display:r?"none":"initial"}},d.createElement("rect",{width:"150",height:"20"}),d.createElement("rect",{y:"30",width:"150",height:"20"}),d.createElement("rect",{y:"60",width:"150",height:"20"})),d.createElement("aside",{className:Y,hidden:!r},d.createElement("a",{className:W,onClick:e=>{e.preventDefault(),i(!1)}}),d.createElement(z,null),t.map((e=>d.createElement("div",{className:n===e?H:"",onClick:()=>l(e),key:e.id},e.nombre))),d.createElement("div",{className:A}),d.createElement("div",{className:U},"Detalles Climáticos"),d.createElement("div",{className:A})))}var $="_noCitySelected_1k0l9_18",Q="_weatherContent_1k0l9_26",K="_cityInfo_1k0l9_37",X="_city_1k0l9_37",Z="_subTitle_1k0l9_55";var V="_ldsRipple_jewt7_1";function ee({show:e,children:t}){return d.createElement(d.Fragment,null,e?d.createElement("div",{className:V},d.createElement("div",null),d.createElement("div",null)):t)}function te({loading:e,weather:t}){var n,a;const r=new Date,i=null==(n=null==t?void 0:t.estadoCielo.find((e=>e.hour===r.getHours().toString())))?void 0:n.value,l=null==(a=null==t?void 0:t.temperatura.find((e=>e.hour===r.getHours().toString())))?void 0:a.value.toFixed(0);return d.createElement(d.Fragment,null,void 0===t?d.createElement("p",{className:$},"Abre el menú y busca tu ciudad. "):null,d.createElement("main",null,d.createElement("div",{className:Q},d.createElement(ee,{show:e||void 0===t},d.createElement("div",null,d.createElement("h1",null,l,"º")),d.createElement("div",{className:K},d.createElement("h2",{className:X},null==t?void 0:t.name),d.createElement("small",{className:Z},v(r,"HH:mm - eeee, d LLLL",{locale:h}))),d.createElement("div",{className:K},d.createElement("img",{src:`./src/assets/weather-icons/${void 0!==i?null==i?void 0:i.toString():""}.svg`}))))))}function ne(){const[e,t]=m.exports.useState(),{loading:n,weather:a}=I(null==e?void 0:e.id);return d.createElement(d.Fragment,null,d.createElement("div",{className:M,style:{background:`url('${void 0===a?"./src/assets/day-sunny.jpg":N(a)}') no-repeat center center fixed`}},d.createElement(G,{onClickCity:e=>t(e),loading:n,weather:a}),d.createElement(te,{loading:n,weather:a})))}function ae(){return d.createElement(d.Fragment,null,d.createElement(g,null,d.createElement(E,{path:"/",component:ne}),d.createElement(E,{path:"/t/:id"},(e=>d.createElement(L,{id:e.id})))))}c.defaults.baseURL="https://opendata.aemet.es/opendata/api/",c.defaults.params={api_key:"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzYW5jaGlzMTk5MkBnbWFpbC5jb20iLCJqdGkiOiIyNDk5YTI0OS00NmMzLTRiNDMtYTA0YS02MGY1M2Q5NTY2NzIiLCJpc3MiOiJBRU1FVCIsImlhdCI6MTYzMTM5OTQ4NiwidXNlcklkIjoiMjQ5OWEyNDktNDZjMy00YjQzLWEwNGEtNjBmNTNkOTU2NjcyIiwicm9sZSI6IiJ9.wCeUbIJ5IuX5x2F4h2Cq1cM75zuhMs2nv-miLfmke1k"},y.render(d.createElement(d.StrictMode,null,d.createElement(k,null,d.createElement(j,null,d.createElement(ae,null)))),document.getElementById("root"));
