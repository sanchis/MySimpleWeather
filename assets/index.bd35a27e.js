var T=Object.defineProperty,F=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var S=(t,e,n)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e)=>{for(var n in e||(e={}))R.call(e,n)&&S(t,n,e[n]);if(k)for(var n of k(e))B.call(e,n)&&S(t,n,e[n]);return t},N=(t,e)=>F(t,O(e));import{a as g,i as I,R as i,r as c,l as E,j as W,f as A,e as P,b as H}from"./vendor.f4388129.js";const J=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};J();function L(t){const e=["00-06","06-12","12-18","18-24"],n=[];return t.filter(a=>e.includes(a.periodo)).forEach(a=>{if(e.includes(a.periodo)){const r=a.periodo.split("-"),s=Number(r[0])+1,l=Number(r[1])+1;for(let o=s;o<l;o++)n.push({hour:o.toString().padStart(2,"0")==="24"?"00":o.toString().padStart(2,"0"),value:a.value})}}),n}function M(t){const e=[];return t.unshift({hora:0,value:t[0].value}),t.forEach((n,a)=>{if(n.hora!==24){const r=Math.abs(t[a+1].value-n.value)/6;for(let s=n.hora;s<t[a+1].hora;s++){const l=r*(s-n.hora);e.push({hour:s.toString(),value:t[a+1].value>n.value?n.value+l:n.value-l})}}else e.push({hour:"00",value:n.value})}),e}function q(t){const e=t.map(n=>({periodo:n.periodo,value:n.value}));return L(e)}function z(t){var m;const e=new Date().getHours(),n=new Date().getHours().toString().padStart(2,"0"),a=["11","11n","81","82","83"],r=["12","12n","14","14n","13n","13","17","17n"],s=["15","16"],l=["43","43n","44","44n","45","46","23","23n","24","24n","25","26"],o=["71","71n","72","72n","73","74","33","33n","34","34n","35","36"],f=["51","51n","52","52n","53","54","61","61n","62","62n","63","64"],d=(m=t.estadoCielo.find(h=>h.hour===n))==null?void 0:m.value.toString(),C=e>=7&&e<=10,y=e>=11&&e<=17,u=e>=18&&e<=22;return d===void 0?"./day-sunny.jpg":d!==void 0&&l.includes(d)?"./day-rain.png":d!==void 0&&f.includes(d)?"./electrical-storm.jpg":d!==void 0&&o.includes(d)?"./snow.jpg":d!==void 0&&r.includes(d)?C?"./sunrise-cloudy.jpg":y?"./day-cloudy.jpg":"./sunset-cloudy.jpg":d!==void 0&&a.includes(d)?C?"./sunrise-sunny.jpg":y?"./day-sunny.jpg":u?"./sunset-sunny.jpg":"./night.jpg":d!==void 0&&s.includes(d)?"./cover.jpg":"./day-sunny.jpg"}function $(t,e,n){return{name:e,date:n,probPrecipitaciones:L(t.probPrecipitacion),humedadMinMax:{max:t.humedadRelativa.maxima,min:t.humedadRelativa.minima},temperaturaMinMax:{max:t.sensTermica.maxima,min:t.sensTermica.minima},estadoCielo:q(t.estadoCielo),humedad:M(t.humedadRelativa.dato),temperatura:M(t.sensTermica.dato)}}async function Y(){const t=await g.get("maestro/municipios").then(e=>e.data);return await g.get(t.datos).then(e=>e.data)}async function U(t){return await g.get(`prediccion/especifica/municipio/diaria/${t.replace("id","")}`).then(e=>e.data).then(e=>{if(e.estado!==200)throw new Error(e.descripcion);return e}).then(async({datos:e})=>await g.get(e)).then(e=>{var n;return{data:e.data[0].prediccion.dia.find(a=>I(new Date(a.fecha))),name:e.data[0].nombre,date:(n=e.data[0].prediccion.dia.find(a=>I(new Date(a.fecha))))==null?void 0:n.fecha}}).then(e=>{if((e==null?void 0:e.data)!==void 0&&(e==null?void 0:e.date)!==void 0)return $(e.data,e.name,new Date(e==null?void 0:e.date));throw new Error("No data found")})}const w=i.createContext({cities:[],setCities:t=>null});function G({children:t}){const[e,n]=c.exports.useState([]);return c.exports.useEffect(()=>{E.getItem("cities").then(a=>{a===null||a.length===0?Y().then(async r=>await E.setItem("cities",r)).then(r=>n(r)).catch(r=>console.error(r)):n(a)}).catch(a=>console.error(a))},[]),i.createElement(w.Provider,{value:{cities:e,setCities:n}},t)}const j=i.createContext({citiesSaved:[],saveCities:()=>{}});function K({children:t}){const[e,n]=c.exports.useState([]);return c.exports.useEffect(()=>{E.setItem("saveCities",e).catch(a=>console.error(a))},[e]),c.exports.useEffect(()=>{E.getItem("saveCities").then(a=>{a!==null&&a.length>0&&n(a)}).catch(a=>console.error(a))},[]),i.createElement(j.Provider,{value:{citiesSaved:e,saveCities:n}},t)}const Q="_mainContainer_1w5gh_1";var V={mainContainer:Q};function X(t){const[e,n]=c.exports.useState(!1),[a,r]=c.exports.useState();return c.exports.useEffect(()=>{t!=null&&(n(!0),U(t).then(s=>r(s)).finally(()=>n(!1)))},[t]),{weather:a,loading:e}}const Z="_autoCompleteBox_bmfp7_1",ee="_autocompleteWrapper_bmfp7_11",te="_item_bmfp7_15",ne="_itemLink_bmfp7_20";var b={autoCompleteBox:Z,autocompleteWrapper:ee,item:te,itemLink:ne};const ae="_input_gsffu_1";var ie={input:ae};function re(t){var e;return i.createElement(i.Fragment,null,i.createElement("input",N(_({},t),{className:`${ie.input} ${(e=t.className)!=null?e:""}`})))}function se(t){const[e,n]=c.exports.useState([]),[a,r]=c.exports.useState(""),[s,l]=c.exports.useState(null),o=c.exports.useRef([]),f=c.exports.useRef(null);c.exports.useEffect(()=>(document.addEventListener("click",d,!1),()=>{document.removeEventListener("click",d,!1)}),[]);const d=u=>{(f==null?void 0:f.current)!==null&&!f.current.contains(u.target)&&n([])},C=c.exports.useCallback(W(u=>r(u),500),[r]),y=u=>{if(u.key!=="ArrowDown"&&u.key!=="ArrowUp")return;const m=s===null?0:o.current.indexOf(s);let h;if(u.key==="ArrowDown"){const x=m+1===o.current.length?0:m+1;h=o.current[x]}else{const x=m-1<0?o.current.length-1:m-1;h=o.current[x]}l(h),h.focus()};return c.exports.useEffect(()=>{var u;return n(t.items.filter(m=>m.label.toLocaleLowerCase().includes(a.toLocaleLowerCase())).slice(0,(u=t.limit)!=null?u:50))},[a]),i.createElement(i.Fragment,null,i.createElement("div",{className:b.autocompleteWrapper,ref:f},i.createElement(re,N(_({},t.input),{onFocus:()=>l(null),onChange:u=>C(u.target.value),onKeyDown:u=>y(u)})),i.createElement("ul",{className:b.autoCompleteBox},e.map(u=>i.createElement("li",{key:u.id,className:b.item},i.createElement("a",{onClick:m=>{m.preventDefault(),t.onClickItem(u),n([])},onKeyDown:m=>y(m),ref:m=>m!==null?o.current.push(m):null,className:b.itemLink},u.label))))))}function oe(){const{cities:t}=c.exports.useContext(w),e=c.exports.useCallback(n=>t.find(a=>a.id===n),[t]);return{cities:t,findCity:e}}function D(){const{saveCities:t,citiesSaved:e}=c.exports.useContext(j),n=c.exports.useCallback(r=>{t(s=>s.some(l=>r.id===l.id)?s:[...s,r])},[e]),a=c.exports.useCallback(r=>{t(s=>s.filter(l=>l.id!==r.id))},[e]);return{savedCities:e,addNewCity:n,deleteCity:a}}function ce(){const{cities:t}=oe(),{addNewCity:e}=D(),n=a=>{e(a.value)};return i.createElement(se,{input:{placeholder:"Busca tu ciudad"},limit:10,placeholder:"Localidad",items:t.map(a=>({id:a.id,label:a.nombre,value:a})),onClickItem:n})}const le="_aside_1qbb5_1",ue="_hamburguer_1qbb5_14",de="_separator_1qbb5_26",me="_selectedCity_1qbb5_30",fe="_header_1qbb5_34",pe="_close_1qbb5_39";var p={aside:le,hamburguer:ue,separator:de,selectedCity:me,header:fe,close:pe};function he({onClickCity:t}){const{savedCities:e}=D(),[n,a]=c.exports.useState(null),[r,s]=c.exports.useState(!1);c.exports.useEffect(()=>{n===null&&e.length>0&&l(e[0])},[e]);const l=o=>{a(o),t(o)};return i.createElement(i.Fragment,null,i.createElement("svg",{onClick:()=>s(!0),viewBox:"0 0 100 80",width:"80",className:p.hamburguer,height:"60",style:{display:r?"none":"initial"}},i.createElement("rect",{width:"150",height:"20"}),i.createElement("rect",{y:"30",width:"150",height:"20"}),i.createElement("rect",{y:"60",width:"150",height:"20"})),i.createElement("aside",{className:p.aside,hidden:!r},i.createElement("a",{className:p.close,onClick:o=>{o.preventDefault(),s(!1)}}),i.createElement(ce,null),e.map(o=>i.createElement("div",{className:n===o?p.selectedCity:"",onClick:()=>l(o),key:o.id},o.nombre)),i.createElement("div",{className:p.separator}),i.createElement("div",{className:p.header},"Detalles Clim\xE1ticos"),i.createElement("div",{className:p.separator})))}const ge="_noCitySelected_1k0l9_18",ve="_weatherContent_1k0l9_26",ye="_cityInfo_1k0l9_37",Ce="_city_1k0l9_37",Ee="_subTitle_1k0l9_55";var v={noCitySelected:ge,weatherContent:ve,cityInfo:ye,city:Ce,subTitle:Ee};const be="_ldsRipple_jewt7_1";var xe={ldsRipple:be};function _e({show:t,children:e}){return i.createElement(i.Fragment,null,t?i.createElement("div",{className:xe.ldsRipple},i.createElement("div",null),i.createElement("div",null)):e)}function Ne({loading:t,weather:e}){var s,l;const n=new Date,a=(s=e==null?void 0:e.estadoCielo.find(o=>o.hour===n.getHours().toString()))==null?void 0:s.value,r=(l=e==null?void 0:e.temperatura.find(o=>o.hour===n.getHours().toString()))==null?void 0:l.value.toFixed(0);return i.createElement(i.Fragment,null,e===void 0?i.createElement("p",{className:v.noCitySelected},"Abre el men\xFA y busca tu ciudad. "):null,i.createElement("main",null,i.createElement("div",{className:v.weatherContent},i.createElement(_e,{show:t||e===void 0},i.createElement("div",null,i.createElement("h1",null,r,"\xBA")),i.createElement("div",{className:v.cityInfo},i.createElement("h2",{className:v.city},e==null?void 0:e.name),i.createElement("small",{className:v.subTitle},A(n,"HH:mm - eeee, d LLLL",{locale:P}))),i.createElement("div",{className:v.cityInfo},i.createElement("img",{src:`./weather-icons/${a!==void 0?a==null?void 0:a.toString():""}.svg`}))))))}function ke(){const[t,e]=c.exports.useState(),{loading:n,weather:a}=X(t==null?void 0:t.id);return i.createElement(i.Fragment,null,i.createElement("div",{className:V.mainContainer,style:{background:`url('${a===void 0?"./day-sunny.jpg":z(a)}') no-repeat center center fixed`}},i.createElement(he,{onClickCity:r=>e(r),loading:n,weather:a}),i.createElement(Ne,{loading:n,weather:a})))}function Se(){return i.createElement(ke,null)}g.defaults.baseURL="https://opendata.aemet.es/opendata/api/";g.defaults.params={api_key:"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzYW5jaGlzMTk5MkBnbWFpbC5jb20iLCJqdGkiOiIyNDk5YTI0OS00NmMzLTRiNDMtYTA0YS02MGY1M2Q5NTY2NzIiLCJpc3MiOiJBRU1FVCIsImlhdCI6MTYzMTM5OTQ4NiwidXNlcklkIjoiMjQ5OWEyNDktNDZjMy00YjQzLWEwNGEtNjBmNTNkOTU2NjcyIiwicm9sZSI6IiJ9.wCeUbIJ5IuX5x2F4h2Cq1cM75zuhMs2nv-miLfmke1k"};H.render(i.createElement(i.StrictMode,null,i.createElement(G,null,i.createElement(K,null,i.createElement(Se,null)))),document.getElementById("root"));
